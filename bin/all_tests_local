#!/bin/bash

# Setup and start Sauce Connect for your local build

#Cleanup and package
.//bin/clean
.//bin/package

if [ ! -f Sauce-connect/Sauce-connect.jar ]; then
    echo "Downloading Sauce-connect!"
    mkdir Sauce-connect                         && \
    cd Sauce-connect                            && \
    curl -sS http://saucelabs.com/downloads/Sauce-Connect-latest.zip > Sauce-Connect-latest.zip && \
    unzip Sauce-Connect-latest.zip                   && \
rm  Sauce-Connect-latest.zip 
fi

java -jar Sauce-Connect.jar joiblumen 19374220-fef6-4897-8922-fa92f7142053 &
sleep 45 # Wait for Sauce to connect
cd ..

.//bin/run
#Run the integration tests
mvn verify
